!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VkAdapter=t():e.VkAdapter=t()}(self,(()=>(()=>{var e={817:function(e,t){!function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)};function r(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}u((n=n.apply(e,t||[])).next())}))}function n(e,t){var r,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function o(e,t,r){if(r||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function s(e,r,n){var o=function(e){var t={current:0,next:function(){return++this.current}},r={};return{add:function(n,o){var s=null!=o?o:"".concat(t.next(),"_").concat(e);return r[s]=n,s},resolve:function(e,t,n){var o=r[e];o&&(n(t)?o.resolve(t):o.reject(t),r[e]=null)}}}(n);return r((function(e){if(e.detail&&e.detail.data&&"object"==typeof e.detail.data&&"request_id"in e.detail.data){var t=e.detail.data,r=t.request_id,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(t,["request_id"]);r&&o.resolve(r,n,(function(e){return!("error_type"in e)}))}})),function(r,n){return void 0===n&&(n={}),new Promise((function(s,i){var a=o.add({resolve:s,reject:i},n.request_id);e(r,t(t({},n),{request_id:a}))}))}}var i,a,u,c,p,l,d,h,v,m,b,f="undefined"!=typeof window,g=Boolean(f&&window.AndroidBridge),A=Boolean(f&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.VKWebAppClose),_=Boolean(f&&window.ReactNativeWebView&&"function"==typeof window.ReactNativeWebView.postMessage),y=f&&!g&&!A,w=y&&/(^\?|&)vk_platform=mobile_web(&|$)/.test(location.search),P=y?"message":"VKWebAppEvent",S=o(["VKWebAppInit","VKWebAppGetCommunityAuthToken","VKWebAppAddToCommunity","VKWebAppAddToHomeScreenInfo","VKWebAppClose","VKWebAppCopyText","VKWebAppCreateHash","VKWebAppGetUserInfo","VKWebAppSetLocation","VKWebAppSendToClient","VKWebAppGetClientVersion","VKWebAppGetPhoneNumber","VKWebAppGetEmail","VKWebAppGetGroupInfo","VKWebAppGetGeodata","VKWebAppGetCommunityToken","VKWebAppGetConfig","VKWebAppGetLaunchParams","VKWebAppSetTitle","VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppJoinGroup","VKWebAppLeaveGroup","VKWebAppAllowMessagesFromGroup","VKWebAppDenyNotifications","VKWebAppAllowNotifications","VKWebAppOpenPayForm","VKWebAppOpenApp","VKWebAppShare","VKWebAppShowWallPostBox","VKWebAppScroll","VKWebAppShowOrderBox","VKWebAppShowLeaderBoardBox","VKWebAppShowInviteBox","VKWebAppShowRequestBox","VKWebAppAddToFavorites","VKWebAppShowStoryBox","VKWebAppStorageGet","VKWebAppStorageGetKeys","VKWebAppStorageSet","VKWebAppFlashGetInfo","VKWebAppSubscribeStoryApp","VKWebAppOpenWallPost","VKWebAppCheckAllowedScopes","VKWebAppCheckBannerAd","VKWebAppHideBannerAd","VKWebAppShowBannerAd","VKWebAppCheckNativeAds","VKWebAppShowNativeAds","VKWebAppRetargetingPixel","VKWebAppConversionHit","VKWebAppShowSubscriptionBox","VKWebAppCheckSurvey","VKWebAppShowSurvey","VKWebAppScrollTop","VKWebAppScrollTopStart","VKWebAppScrollTopStop","VKWebAppShowSlidesSheet","VKWebAppTranslate","VKWebAppRecommend","VKWebAppAddToProfile","VKWebAppGetFriends"],y&&!w?["VKWebAppResizeWindow","VKWebAppAddToMenu","VKWebAppShowInstallPushBox","VKWebAppShowCommunityWidgetPreviewBox","VKWebAppCallStart","VKWebAppCallJoin","VKWebAppCallGetStatus"]:["VKWebAppShowImages"],!0),V=f?window.AndroidBridge:void 0,W=A?window.webkit.messageHandlers:void 0,K=y?parent:void 0;e.EAdsFormats=void 0,(a=e.EAdsFormats||(e.EAdsFormats={})).REWARD="reward",a.INTERSTITIAL="interstitial",e.BannerAdLayoutType=void 0,(u=e.BannerAdLayoutType||(e.BannerAdLayoutType={})).RESIZE="resize",u.OVERLAY="overlay",e.BannerAdLocation=void 0,(c=e.BannerAdLocation||(e.BannerAdLocation={})).TOP="top",c.BOTTOM="bottom",e.BannerAdAlign=void 0,(p=e.BannerAdAlign||(e.BannerAdAlign={})).LEFT="left",p.RIGHT="right",p.CENTER="center",e.BannerAdHeightType=void 0,(l=e.BannerAdHeightType||(e.BannerAdHeightType={})).COMPACT="compact",l.REGULAR="regular",e.BannerAdOrientation=void 0,(d=e.BannerAdOrientation||(e.BannerAdOrientation={})).HORIZONTAL="horizontal",d.VERTICAL="vertical",e.EGrantedPermission=void 0,(h=e.EGrantedPermission||(e.EGrantedPermission={})).CAMERA="camera",h.LOCATION="location",h.PHOTO="photo",e.EGetLaunchParamsResponseLanguages=void 0,(v=e.EGetLaunchParamsResponseLanguages||(e.EGetLaunchParamsResponseLanguages={})).RU="ru",v.UK="uk",v.UA="ua",v.EN="en",v.BE="be",v.KZ="kz",v.PT="pt",v.ES="es",e.EGetLaunchParamsResponseGroupRole=void 0,(m=e.EGetLaunchParamsResponseGroupRole||(e.EGetLaunchParamsResponseGroupRole={})).ADMIN="admin",m.EDITOR="editor",m.MEMBER="member",m.MODER="moder",m.NONE="none",e.EGetLaunchParamsResponsePlatforms=void 0,(b=e.EGetLaunchParamsResponsePlatforms||(e.EGetLaunchParamsResponsePlatforms={})).DESKTOP_WEB="desktop_web",b.DESKTOP_WEB_MESSENGER="desktop_web_messenger",b.DESKTOP_APP_MESSENGER="desktop_app_messenger",b.MOBILE_WEB="mobile_web",b.MOBILE_ANDROID="mobile_android",b.MOBILE_ANDROID_MESSENGER="mobile_android_messenger",b.MOBILE_IPHONE="mobile_iphone",b.MOBILE_IPHONE_MESSENGER="mobile_iphone_messenger",b.MOBILE_IPAD="mobile_ipad";var E=function(e){var t=void 0,a=[],u=Math.random().toString(36).substring(2,5);function c(e){a.push(e)}function p(e){return g?!(!V||"function"!=typeof V[e]):A?!(!W||!W[e]||"function"!=typeof W[e].postMessage):!!y&&S.includes(e)}function l(){return A||g}function d(){return y&&window.parent!==window}function h(){return l()||d()}function v(e){if(A||g)return o([],a,!0).map((function(t){return t.call(null,e)}));var r=null==e?void 0:e.data;if(y&&r){if(_&&"string"==typeof r)try{r=JSON.parse(r)}catch(e){}var n=r.type,s=r.data,i=r.frameId;n&&("VKWebAppSettings"!==n?o([],a,!0).map((function(e){return e({detail:{type:n,data:s}})})):t=i)}}_&&/(android)/i.test(navigator.userAgent)?document.addEventListener(P,v):"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener(P,v);var m=s((function(r,n){V&&V[r]?V[r](JSON.stringify(n)):W&&W[r]&&"function"==typeof W[r].postMessage?W[r].postMessage(n):_?window.ReactNativeWebView.postMessage(JSON.stringify({handler:r,params:n})):K&&"function"==typeof K.postMessage&&K.postMessage({handler:r,params:n,type:"vk-connect",webFrameId:t,connectVersion:e},"*")}),c,u);return c((function(e){e.detail&&"SetSupportedHandlers"===e.detail.type&&(i=new Set(e.detail.data.supportedHandlers))})),{send:m,sendPromise:m,subscribe:c,unsubscribe:function(e){var t=a.indexOf(e);t>-1&&a.splice(t,1)},supports:function(e){return console.warn("bridge.supports method is deprecated. Use bridge.supportsAsync instead."),p(e)},supportsAsync:function(e){return r(this,void 0,void 0,(function(){var t;return n(this,(function(r){switch(r.label){case 0:if(g||A)return[2,p(e)];if(i)return[2,i.has(e)];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m("SetSupportedHandlers")];case 2:return t=r.sent(),i=new Set(t.supportedHandlers),[3,4];case 3:return r.sent(),i=new Set(["VKWebAppInit"]),[3,4];case 4:return[2,i.has(e)]}}))}))},isWebView:l,isIframe:d,isEmbedded:h,isStandalone:function(){return!h()}}}("2.15.6");e.applyMiddleware=function e(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return r.includes(void 0)||r.includes(null)?e.apply(void 0,r.filter((function(e){return"function"==typeof e}))):function(e){if(0===r.length)return e;var n,o={subscribe:e.subscribe,send:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.send.apply(e,t)}},s=r.filter((function(e){return"function"==typeof e})).map((function(e){return e(o)})).reduce((function(e,t){return function(r){return e(t(r))}}));return n=s(e.send),t(t({},e),{send:n})}},e.default=E,e.parseURLSearchParamsForGetLaunchParams=function(t){var r={};try{new URLSearchParams(t).forEach((function(t,n){switch(n){case"vk_ts":case"vk_is_recommended":case"vk_profile_id":case"vk_has_profile_button":case"vk_testing_group_id":case"vk_user_id":case"vk_app_id":case"vk_group_id":r[n]=Number(t);break;case"sign":case"vk_chat_id":case"vk_ref":case"vk_access_token_settings":r[n]=t;break;case"odr_enabled":r.odr_enabled="1"===t?1:void 0;break;case"vk_is_app_user":case"vk_are_notifications_enabled":case"vk_is_favorite":r[n]=function(e){switch(e){case"0":return 0;case"1":return 1;default:return}}(t);break;case"vk_language":r.vk_language=function(t){return Object.values(e.EGetLaunchParamsResponseLanguages).some((function(e){return e===t}))}(t)?t:void 0;break;case"vk_viewer_group_role":r.vk_viewer_group_role=function(t){return Object.values(e.EGetLaunchParamsResponseGroupRole).some((function(e){return e===t}))}(t)?t:void 0;break;case"vk_platform":r.vk_platform=function(t){return Object.values(e.EGetLaunchParamsResponsePlatforms).some((function(e){return e===t}))}(t)?t:void 0}}))}catch(e){console.warn(e)}return r},Object.defineProperty(e,"__esModule",{value:!0})}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};return(()=>{"use strict";r.d(n,{default:()=>A});class e{init(){return Promise.resolve(!1)}showPreroll(){return this.showInterstitial()}showRewarded(){return Promise.resolve({success:!1,error:"rewarded not supported"})}showInterstitial(){return Promise.resolve({success:!1,error:"interstitial not supported"})}showBannerAd(){return Promise.resolve({success:!1,error:"banner not supported"})}hideBannerAd(){return Promise.resolve({success:!1,error:"banner not supported"})}}class t{init(){return Promise.resolve(!1)}isAuth(){return Promise.resolve(!1)}auth(){return Promise.resolve(!1)}getId(){return""}getLang(){return""}getName(){return""}getAvatar(){return""}loadData(e){return Promise.resolve(null)}saveData(e){return Promise.resolve(null)}}class o{constructor(){}init(){return Promise.resolve()}isAvailable(){return Promise.resolve(!1)}getCatalog(){return Promise.resolve()}buy(e){return Promise.resolve()}getPurchases(){return Promise.resolve()}consumePurchase(e){return Promise.resolve()}}class s{constructor(){}init(){return Promise.resolve()}}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class a{constructor(e){this.options=e,i(this,"_isReady",!1),i(this,"initResolves",[]),i(this,"api",void 0),i(this,"advertising",void 0),i(this,"player",void 0),i(this,"social",void 0),i(this,"purchase",void 0),i(this,"modules",[]),this.advertising=this.createAdvertising(),this.player=this.createPlayer(),this.social=this.createSocial(),this.purchase=this.createPurchase(),this.modules.push(this.advertising,this.player,this.social,this.purchase),this.initSelf()}get isReady(){return this._isReady}init(){return this.isReady?Promise.resolve():this.getInitPromise()}gameReady(){}loading(){}getApi(){return this.api}createAdvertising(){return new e}createPlayer(){return new t}createSocial(){return new s}createPurchase(){return new o}initSelf(){let e=!1;const t=()=>{e||(e=!0,this.initApi().then((()=>this.initModules())).then((()=>{this._isReady=!0,this.callInitResolves()})).catch((e=>{console.error(e)})))};window.addEventListener("load",t),"complete"===document.readyState&&t()}initApi(){return Promise.resolve()}initModules(){return Promise.all(this.modules.map((e=>e.init())))}getInitPromise(){return new Promise((e=>{this.initResolves.push(e)}))}callInitResolves(){this.initResolves.forEach((e=>{e()})),this.initResolves=[]}}var u=r(817),c=r.n(u);function p(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends e{constructor(e){super(),this.adapter=e,p(this,"isAndroid",!1)}showInterstitial(){return c().send("VKWebAppShowNativeAds",{ad_format:"interstitial"}).then((e=>({success:e.result}))).catch((e=>(console.error("VK interstitial error:",e),{success:!1,error:e})))}showRewarded(){return c().send("VKWebAppShowNativeAds",{ad_format:"reward"}).then((e=>({success:e.result}))).catch((e=>(console.error("VK rewarded error:",e),{success:!1,error:e})))}showBannerAd(){return c().send("VKWebAppShowBannerAd",{banner_location:"bottom"}).then((()=>({success:!0}))).catch((e=>(console.error("VK banner error:",e),{success:!1,error:"banner not supported"})))}createShortcut(){return c().send("VKWebAppAddToHomeScreen").then((e=>!!e.result)).catch((e=>(console.error(e),!1)))}canCreateShortcut(){return c().send("VKWebAppAddToHomeScreenInfo").then((e=>e.is_feature_supported&&!e.is_added_to_home_screen)).catch((e=>(console.error(e),!1)))}}function d(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class h extends t{constructor(e){super(),this.adapter=e,d(this,"gets",{}),d(this,"__loaded",!1),d(this,"group_id","group_id"),d(this,"score",{}),d(this,"userId",null),d(this,"language","ru"),this.initUserData()}async initUserData(){try{const e=await c().send("VKWebAppGetUserInfo");this.userId=e.id,this.language=e.language||"ru"}catch(e){console.error("Failed to get VK user info:",e)}}getId(){return String(this.getFromGets("vk_user_id")||"")}getLang(){return String(this.getFromGets("vk_language")||"")}getName(){return""}getAvatar(){return""}getFromGets(e){return this.gets[e]||null}isAuth(){return Promise.resolve(this.__loaded)}auth(){return Promise.resolve(!1)}initGetData(){["vk_user_id","vk_language","vk_app_id","vk_is_favorite","is_member","vk_are_notifications_enabled"].forEach((e=>{this.gets[e]=this.getParamsFromGET(e)}))}getParamsFromGET(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length){try{const e=new URLSearchParams(window.location.search);if(1===t.length)return e.get(t[0]);{const r={};return t.forEach((t=>{r[t]=e.get(t)})),r}}catch(e){console.error("URLSearchParams not supported")}return!1}}initMember(){return this.__isMember().then((e=>{this.gets.vk_is_member=e}))}__isMember(){return c().send("VKWebAppGetGroupInfo",{group_id:this.group_id}).then((e=>Promise.resolve(!!Number(e?.is_member||0)))).catch((e=>Promise.resolve(!1)))}initScore(){return this.getScore(!0).then((e=>{this.score=e||0}))}getScore(e){}getUsersDataVk(e){return c().send("VKWebAppGetUserInfo",{user_ids:e.join(",")}).catch((e=>(console.log(e),[])))}getLbData(){return super.getLbData().then((e=>this.getUsersDataVk(e.map((e=>e.id))).then((t=>{console.log("VK users data",t,e.map((e=>e.id)));const r=t=>{const r=e.find((e=>Number(e.id)==t.id));if(!r)return;const n=t.first_name||"",o=t.last_name||"";r.avatar=t.photo_100||"",r.title=n+(o?" "+o:"")||""};return t?.result?t.result.forEach(r):t&&r(t),e}))))}}function v(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class m extends o{constructor(e){super(),this.adapter=e,v(this,"appId","512002432556"),v(this,"currency",[]),v(this,"lang",""),v(this,"catalog",{})}buy(e){return c().send("VKWebAppShowOrderBox",{type:"item",item:e}).then((e=>e.success?this.tryGetPurchases():Promise.reject())).then((t=>{const r=t.find((t=>t.productID===e));return r||!1})).catch((()=>!1))}tryGetPurchases(){let e=5;return new Promise(((t,r)=>{const n=()=>{if(e<=0)return r(null);e-=1,setTimeout((()=>{this.getPurchases().then((e=>{e.length?t(e):n()})).catch((e=>{console.error(e),n()}))}),1e3*(1+.3*Math.pow(5-e,2)))};n()}))}getPurchases(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.server.request("https://bbb.dra.games/api/purchase/vk/get-transactions",{app_id:String(this.appId),user_id:this.getId()}).then((e=>(console.log("getPurchase",e),e.error?Promise.reject(e.error):e.data.filter((e=>"closed"!==e.status)).map((e=>({purchaseToken:e.transaction_id,productID:e.data.item_id})))||[]))).catch((t=>(console.error("getPurchase",t),e<=1?[]:this.getPurchases(e-1))))}consumePurchase(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return c().send("VKWebAppGetLaunchParams").then((t=>this.server.request("https://bbb.dra.games/api/purchase/vk/close-transaction",{transaction_id:e,app_id:String(this.appId),user_id:this.getId(),sign:t}))).then((e=>(console.log("consumePurchase",e),!e.error||Promise.reject(e.error)))).catch((r=>(console.error("consumePurchase",r),!(t<=1)&&this.consumePurchase(e,t-1))))}getCatalog(){return fetch("https://dravk.ru/slova_vk/shop/items.json?t="+Date.now()).then((e=>e.json())).then((e=>(this.catalog=Object.keys(e).map((t=>{const r=e[t].price;return{id:t,price:r+" "+this.getCurrency(r),priceValue:r}})),!0))).catch((e=>(console.error("loadCatalog",e),!1)))}getCurrency(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this.currency[this.lang]||this.currency.ru;return t?"string"==typeof t?t:t[e]||t["*"+e%10]||t["*"]||t[Object.keys(t)[0]]:"VK"}}function b(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f extends s{constructor(e){super(),this.adapter=e,b(this,"gets",{})}sendProgress(e){this.sendAppEvent(1,e)}sendAppEvent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;return fetch("https://dravk.ru/slova_vk/secure_addAppEvent.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:this.getFromGets("vk_user_id"),v:"5.199",activity_id:e,value:t})}).then((e=>e.json())).then((e=>!e.error&&(console.log("secure_addAppEvent",e),!0))).catch((e=>(console.error("secure_addAppEvent",e),!1)))}getFromGets(e){return this.gets[e]||null}showLb(){return c().send("VKWebAppShowLeaderBoardBox").then((e=>Promise.resolve(!!e?.success||!1))).catch((e=>(console.warn(e),Promise.resolve(!1))))}sendPost(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e=e.replace("{url}",this.adapter.options.game_url),c().send("VKWebAppShowWallPostBox",{message:e+"\n"+this.gameUrl,attachments:this.gameUrl,owner_id:Number(this.getId())}).then((e=>Promise.resolve(!0))).catch((e=>(console.warn(e),Promise.resolve(!1))))}canInvite(){return Promise.resolve(!0)}invite(){return c().send("VKWebAppShowInviteBox",{}).then((e=>Promise.resolve(!!e?.success||!1))).catch((e=>(console.warn(e),Promise.resolve(!1))))}openGroup(){gipi.openLink(this.groupUrl)}isMember(){return isIOS&&this.game?Promise.resolve(!!Number(this.game.storage.getItem("group")||0)):Promise.resolve(this.getFromGets("vk_is_member")||!!Number(this.getFromGets("is_member")||0))}canMember(){return this.isMember().then((e=>!e))}__isMember(){return c().send("VKWebAppGetGroupInfo",{group_id:this.group_id}).then((e=>Promise.resolve(!!Number(e?.is_member||0)))).catch((e=>Promise.resolve(!1)))}member(){return c().send("VKWebAppJoinGroup",{group_id:this.group_id}).then((e=>(e.result&&(this.gets.vk_is_member=!0),Promise.resolve(!!e?.result)))).catch((e=>(console.warn(e),Promise.resolve(!1))))}favorite(){return c().send("VKWebAppAddToFavorites").then((e=>!!e.result)).catch((e=>(console.error(e),!1))).then((e=>(e&&(this.gets.vk_is_favorite=!0),e)))}isFavorite(){return Promise.resolve(!!Number(this.getFromGets("vk_is_favorite")))}canAddToFavorite(){return this.isFavorite().then((e=>!e))}matchBonuses(){return Promise.all([this.isMember(),this.isFavorite()]).then((e=>e.filter((e=>e)).length-.5))}isSignedForEvents(){return Promise.resolve(!!Number(this.getFromGets("vk_are_notifications_enabled")))}signedForEvents(){return c().send("VKWebAppAllowNotifications").then((e=>!!e.result&&(this.gets.vk_are_notifications_enabled=1,!0))).catch((e=>(console.log(e),!1)))}canSignedForEvents(){return this.isSignedForEvents().then((e=>!e))}}function g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class A extends a{constructor(e){super(e),g(this,"gets",new _(this)),console.log("VkAdapter"),c().send("VKWebAppInit",{}),this.gets.init()}createAdvertising(){return new l(this)}createPlayer(){return new h(this)}createPurchase(){return new m(this)}createSocial(){return new f(this)}}class _{constructor(e){this.adapter=e,g(this,"data",{}),this.adapter=e}init(){}get(e){return this.data[e]}}})(),n=n.default})()));